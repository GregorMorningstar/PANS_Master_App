import{c as Re,r as b,j as t,u as Fe,a as Ge}from"./app-6VWvmULT.js";import{M as Ke}from"./ModeratorLayout-BuZ7YoP3.js";import{B as Oe}from"./app-sidebar-layout-DRLK_nj4.js";import{G as We}from"./glasses-mSj487L1.js";import{a as Ue}from"./app-logo-icon-DrFhGwKx.js";import{C as He}from"./ConfirmDialog-Bg-KjzEl.js";/* empty css            */import"./index-BCaWy0DS.js";import"./index-C2gJ1Fua.js";import"./index-C4J_hXM0.js";import"./index-DG9SYJJy.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Je=Ue("SquarePen",Ze);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xe=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Ye=Ue("Trash",Xe),$e=15,et={working:"bg-green-100 text-green-800",breakdown:"bg-red-100 text-red-800",active:"bg-blue-100 text-blue-800",inactive:"bg-slate-100 text-slate-800",maintenance:"bg-yellow-100 text-yellow-800",decommissioned:"bg-gray-700 text-white",forced_downtime:"bg-yellow-100 text-yellow-800"},Te={working:"bg-green-50",breakdown:"bg-red-50",active:"bg-blue-50",inactive:"bg-slate-50",maintenance:"bg-yellow-50",decommissioned:"bg-gray-100",forced_downtime:"bg-amber-50"},tt={working:"Pracuje",breakdown:"Awaria",active:"Aktywna",inactive:"Nieaktywna",maintenance:"Serwis / konserwacja",decommissioned:"Wycofana",forced_downtime:"Postój wymuszony"};function Ee(s){if(!s)return"bg-gray-50 text-gray-700";const e=String(s).toLowerCase();return et[e]??"bg-gray-50 text-gray-700"}function Ce(s){if(!s)return"Brak";const e=String(s).toLowerCase();return tt[e]??String(s)}function st(s){if(!s)return"";const e=String(s).toLowerCase();return Te[e]?`${Te[e]}`:""}function at(s){const e=Re.c(114),{allOperations:p,enumStatuses:v,currentUserRole:g,onDelete:m}=s;let A;e[0]!==p?(A=p===void 0?[]:p,e[0]=p,e[1]=A):A=e[1];const x=A;let O;e[2]!==v?(O=v===void 0?[]:v,e[2]=v,e[3]=O):O=e[3];const S=O,w=g===void 0?"user":g,[$,N]=b.useState(1),[d,k]=b.useState(""),[o,ae]=b.useState(""),[i,E]=b.useState(""),[f,P]=b.useState("");let oe;e[4]===Symbol.for("react.memo_cache_sentinel")?(oe=[],e[4]=oe):oe=e[4];const[_e,Qe]=b.useState(oe),[ne]=b.useState(null),[r,me]=b.useState(null);let de,xe;e[5]===Symbol.for("react.memo_cache_sentinel")?(de=()=>{let a=!0;return fetch("/operationmachines/statuses").then(ct).then(l=>{a&&Array.isArray(l)&&Qe(l.map(String))}).catch(it),()=>{a=!1}},xe=[],e[5]=de,e[6]=xe):(de=e[5],xe=e[6]),b.useEffect(de,xe);let he,ue;e[7]===Symbol.for("react.memo_cache_sentinel")?(ue=()=>{const a=function(u){u.key==="Escape"&&me(null)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},he=[],e[7]=he,e[8]=ue):(he=e[7],ue=e[8]),b.useEffect(ue,he);let fe;if(e[9]!==x||e[10]!==S||e[11]!==_e){const a=new Set;(S||[]).forEach(l=>l&&a.add(String(l))),(_e||[]).forEach(l=>l&&a.add(String(l))),(x||[]).forEach(l=>{const u=l.machine?.status??l.machine?.status_name??"",j=l.status??l.status_name??l.status?.name??"";u&&a.add(String(u)),j&&a.add(String(j))}),fe=Array.from(a).sort(),e[9]=x,e[10]=S,e[11]=_e,e[12]=fe}else fe=e[12];const le=fe;let be;e[13]===Symbol.for("react.memo_cache_sentinel")?(be=()=>{N(1)},e[13]=be):be=e[13];let je;e[14]!==o||e[15]!==i||e[16]!==d||e[17]!==f?(je=[d,o,i,f],e[14]=o,e[15]=i,e[16]=d,e[17]=f,e[18]=je):je=e[18],b.useEffect(be,je);let ze;e:{if(!Array.isArray(x)){let l;e[19]===Symbol.for("react.memo_cache_sentinel")?(l=[],e[19]=l):l=e[19],ze=l;break e}let a;if(e[20]!==x||e[21]!==o||e[22]!==i||e[23]!==d||e[24]!==f){const l=d.trim().toLowerCase(),u=o.trim().toLowerCase(),j=i.trim().toLowerCase(),z=f.trim().toLowerCase();a=x.filter(c=>{const M=(c.operation?.name??c.operation_name??"").toString().toLowerCase(),X=(c.operation?.barcode??c.operation_barcode??c.barcode??"").toString().toLowerCase(),Y=(c.machine?.name??c.machine_name??"").toString().toLowerCase(),L=(c.machine?.status??c.machine?.status_name??c.machine?.status?.name??"").toString().toLowerCase(),ee=(c.status??c.status_name??c.status?.name??"").toString().toLowerCase();return!(l&&!M.includes(l)||u&&!X.includes(u)||j&&!Y.includes(j)||z&&!(L.includes(z)||ee.includes(z)))}),e[20]=x,e[21]=o,e[22]=i,e[23]=d,e[24]=f,e[25]=a}else a=e[25];ze=a}const pe=ze;if(!Array.isArray(x)||x.length===0){let a;return e[26]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx("div",{children:"Brak operacji"}),e[26]=a):a=e[26],a}const re=pe.length,h=Math.max(1,Math.ceil(re/$e)),y=Math.min(Math.max(1,$),h),ie=(y-1)*$e,B=Math.min(ie+$e,re);let D,I,C,T,_;if(e[27]!==o||e[28]!==w||e[29]!==B||e[30]!==pe||e[31]!==i||e[32]!==m||e[33]!==d||e[34]!==ne||e[35]!==ie||e[36]!==f||e[37]!==le){const a=pe.slice(ie,B);let l;e[43]===Symbol.for("react.memo_cache_sentinel")?(l=t.jsx("label",{className:"text-xs",children:"Nazwa operacji"}),e[43]=l):l=e[43];let u;e[44]===Symbol.for("react.memo_cache_sentinel")?(u=n=>k(n.target.value),e[44]=u):u=e[44];let j;e[45]!==d?(j=t.jsxs("div",{className:"flex flex-col",children:[l,t.jsx("input",{value:d,onChange:u,className:"border px-2 py-1",placeholder:"Szukaj po nazwie operacji"})]}),e[45]=d,e[46]=j):j=e[46];let z;e[47]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsx("label",{className:"text-xs",children:"Barcode operacji"}),e[47]=z):z=e[47];let c;e[48]===Symbol.for("react.memo_cache_sentinel")?(c=n=>ae(n.target.value),e[48]=c):c=e[48];let M;e[49]!==o?(M=t.jsxs("div",{className:"flex flex-col",children:[z,t.jsx("input",{value:o,onChange:c,className:"border px-2 py-1",placeholder:"Szukaj po barcode"})]}),e[49]=o,e[50]=M):M=e[50];let X;e[51]===Symbol.for("react.memo_cache_sentinel")?(X=t.jsx("label",{className:"text-xs",children:"Nazwa maszyny"}),e[51]=X):X=e[51];let Y;e[52]===Symbol.for("react.memo_cache_sentinel")?(Y=n=>E(n.target.value),e[52]=Y):Y=e[52];let L;e[53]!==i?(L=t.jsxs("div",{className:"flex flex-col",children:[X,t.jsx("input",{value:i,onChange:Y,className:"border px-2 py-1",placeholder:"Szukaj po nazwie maszyny"})]}),e[53]=i,e[54]=L):L=e[54];let ee;e[55]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx("label",{className:"text-xs",children:"Status"}),e[55]=ee):ee=e[55];let Ne;e[56]===Symbol.for("react.memo_cache_sentinel")?(Ne=n=>P(n.target.value),e[56]=Ne):Ne=e[56];let ve;e[57]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsx("option",{value:"",children:"Wszystkie"}),e[57]=ve):ve=e[57];let te;e[58]!==le?(te=le.map(rt),e[58]=le,e[59]=te):te=e[59];let se;e[60]!==f||e[61]!==te?(se=t.jsxs("div",{className:"flex flex-col",children:[ee,t.jsxs("select",{value:f,onChange:Ne,className:"border px-2 py-1",children:[ve,te]})]}),e[60]=f,e[61]=te,e[62]=se):se=e[62],e[63]!==j||e[64]!==M||e[65]!==L||e[66]!==se?(_=t.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:space-x-4 mb-4",children:[j,M,L,se]}),e[63]=j,e[64]=M,e[65]=L,e[66]=se,e[67]=_):_=e[67],T="overflow-x-auto",I="min-w-full text-sm",e[68]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"text-left px-2 py-1",children:"Nazwa operacji"}),t.jsx("th",{className:"text-left px-2 py-1",children:"Barcode operacji"}),t.jsx("th",{className:"text-left px-2 py-1",children:"Nazwa maszyny"}),t.jsx("th",{className:"text-left px-2 py-1",children:"Status maszyny"}),t.jsx("th",{className:"text-left px-2 py-1",children:"Akcje"})]})}),e[68]=C):C=e[68];let Se;e[69]!==w||e[70]!==m||e[71]!==ne?(Se=n=>{const Pe=n.id??`${n.operation?.id??""}-${n.machine_id??""}`,Be=n.operation?.name??n.operation_name??"",we=n.operation?.barcode??n.operation_barcode??n.barcode??"",De=n.machine?.name??n.machine_name??"",ce=n.machine?.status??n.machine?.status_name??n.machine?.status?.name??""??"",ke=n.duration_minutes??null,qe=Ee(ce),Ve=st(ce);return t.jsxs("tr",{className:`border-t relative ${Ve}`,children:[t.jsx("td",{className:"px-2 py-1",children:t.jsx("span",{title:ke?`Czas trwania: ${ke} sek`:void 0,className:"cursor-help",children:Be})}),t.jsx("td",{className:"px-2 py-1",children:t.jsxs("div",{className:"inline-block",children:[t.jsx(Oe,{value:we||" ",height:40,displayValue:!1}),t.jsx("div",{className:"text-xs truncate max-w-[120px]",children:we})]})}),t.jsx("td",{className:"px-2 py-1",children:De}),t.jsx("td",{className:"px-2 py-1",children:t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs ${qe}`,children:Ce(ce)})}),t.jsxs("td",{className:"px-2 py-1 relative overflow-visible",children:[t.jsx("button",{onClick:()=>me(n),className:"mr-2 text-sm text-blue-600",children:t.jsx(We,{className:"w-4 h-4 inline-block"})}),w==="moderator"||w==="admin"?t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>{const Ie=n.id??n.operation_id??n.operation?.id;Ie&&(window.location.href=`/moderator/machines/operations/${Ie}/edit`)},className:"mr-2 text-sm text-green-600",children:t.jsx(Je,{className:"w-4 h-4 inline-block"})}),t.jsx("button",{onClick:()=>m?m(n):console.log("delete",n),className:"mr-2 text-sm text-red-600",children:t.jsx(Ye,{className:"w-4 h-4 inline-block"})})]}):null,ne===Pe&&t.jsx("div",{className:"absolute z-50 right-0 -top-2 w-80 bg-white border rounded shadow-lg p-3 text-sm origin-top-right transform-gpu transition-transform scale-100",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h5",{className:"font-medium mb-1",children:"Maszyna"}),t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-semibold",children:De||"—"}),t.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",n.machine?.id??n.machine_id??"—"]}),n.machine?.barcode&&t.jsxs("div",{className:"mt-1 text-xs",children:["Barcode: ",t.jsx("span",{className:"font-mono",children:n.machine.barcode})]}),t.jsx("div",{className:"mt-2",children:t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs ${Ee(ce)}`,children:Ce(ce)})})]})]}),t.jsx("div",{className:"w-[1px] bg-gray-100"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h5",{className:"font-medium mb-1",children:"Operacja"}),t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-semibold",children:Be||"—"}),t.jsxs("div",{className:"text-xs text-gray-500",children:["Czas: ",ke?`${ke} sek`:"—"]}),t.jsxs("div",{className:"text-xs text-gray-500",children:["Przezbrojenie: ",n.changeover_time??"—"]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("div",{className:"inline-block p-1 bg-gray-50 rounded",children:t.jsx(Oe,{value:we||" ",height:30,displayValue:!1})}),t.jsx("div",{className:"text-xs truncate mt-1",children:we||"—"})]})]})]})]})})]})]},Pe)},e[69]=w,e[70]=m,e[71]=ne,e[72]=Se):Se=e[72],D=a.map(Se),e[27]=o,e[28]=w,e[29]=B,e[30]=pe,e[31]=i,e[32]=m,e[33]=d,e[34]=ne,e[35]=ie,e[36]=f,e[37]=le,e[38]=D,e[39]=I,e[40]=C,e[41]=T,e[42]=_}else D=e[38],I=e[39],C=e[40],T=e[41],_=e[42];let R;e[73]!==D?(R=t.jsx("tbody",{children:D}),e[73]=D,e[74]=R):R=e[74];let U;e[75]!==I||e[76]!==C||e[77]!==R?(U=t.jsxs("table",{className:I,children:[C,R]}),e[75]=I,e[76]=C,e[77]=R,e[78]=U):U=e[78];let Q;e[79]!==T||e[80]!==U?(Q=t.jsx("div",{className:T,children:U}),e[79]=T,e[80]=U,e[81]=Q):Q=e[81];const Me=ie+1;let q;e[82]!==B||e[83]!==Me||e[84]!==re?(q=t.jsxs("div",{className:"text-xs",children:["Pokazano ",Me," - ",B," z ",re]}),e[82]=B,e[83]=Me,e[84]=re,e[85]=q):q=e[85];let ye;e[86]===Symbol.for("react.memo_cache_sentinel")?(ye=()=>N(lt),e[86]=ye):ye=e[86];const Le=y===1;let V;e[87]!==Le?(V=t.jsx("button",{onClick:ye,disabled:Le,className:"px-2 py-1 border rounded disabled:opacity-50",children:"Prev"}),e[87]=Le,e[88]=V):V=e[88];let F;e[89]!==h?(F=Array.from({length:h},nt),e[89]=h,e[90]=F):F=e[90];let G;e[91]!==y||e[92]!==F||e[93]!==h?(G=t.jsx("div",{className:"flex items-center space-x-1",children:F.map(a=>{if(h>7){const l=y-2,u=y+2;return a===1||a===h||a>=l&&a<=u?t.jsx("button",{onClick:()=>N(a),className:`px-2 py-1 border rounded ${a===y?"bg-gray-200":""}`,children:a},a):a===2&&y>4?t.jsx("span",{className:"px-2",children:"..."},a):a===h-1&&y<h-3?t.jsx("span",{className:"px-2",children:"..."},a):null}return t.jsx("button",{onClick:()=>N(a),className:`px-2 py-1 border rounded ${a===y?"bg-gray-200":""}`,children:a},a)})}),e[91]=y,e[92]=F,e[93]=h,e[94]=G):G=e[94];let K;e[95]!==h?(K=()=>N(a=>Math.min(h,a+1)),e[95]=h,e[96]=K):K=e[96];const Ae=y===h;let W;e[97]!==K||e[98]!==Ae?(W=t.jsx("button",{onClick:K,disabled:Ae,className:"px-2 py-1 border rounded disabled:opacity-50",children:"Next"}),e[97]=K,e[98]=Ae,e[99]=W):W=e[99];let H;e[100]!==V||e[101]!==G||e[102]!==W?(H=t.jsxs("div",{className:"flex items-center space-x-2",children:[V,G,W]}),e[100]=V,e[101]=G,e[102]=W,e[103]=H):H=e[103];let Z;e[104]!==q||e[105]!==H?(Z=t.jsxs("div",{className:"flex items-center justify-between mt-3",children:[q,H]}),e[104]=q,e[105]=H,e[106]=Z):Z=e[106];let J;e[107]!==r?(J=r&&t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",role:"dialog","aria-modal":"true",onClick:a=>{a.target===a.currentTarget&&me(null)},children:t.jsxs("div",{className:"relative w-full max-w-3xl bg-white rounded shadow-lg p-6 mx-4",children:[t.jsx("button",{"aria-label":"Zamknij",onClick:()=>me(null),className:"absolute top-3 right-3 text-gray-600 hover:text-black",children:"✕"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-2",children:"Maszyna"}),t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-semibold",children:r.machine?.name??r.machine_name??"—"}),t.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",r.machine?.id??r.machine_id??"—"]}),r.machine?.barcode&&t.jsxs("div",{className:"mt-1 text-xs",children:["Barcode: ",t.jsx("span",{className:"font-mono",children:r.machine.barcode})]}),t.jsx("div",{className:"mt-2",children:t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs ${Ee(r.machine?.status??r.machine?.status_name)}`,children:Ce(r.machine?.status??r.machine?.status_name)})})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold mb-2",children:"Operacja"}),t.jsxs("div",{className:"text-sm",children:[t.jsx("div",{className:"font-semibold",children:r.operation?.name??r.operation_name??"—"}),t.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",r.operation?.id??r.operation_id??"—"]}),t.jsxs("div",{className:"mt-3",children:[t.jsx("div",{className:"inline-block p-1 bg-gray-50 rounded",children:t.jsx(Oe,{value:r.operation?.barcode??r.operation_barcode??r.barcode??" ",height:50,displayValue:!0})}),t.jsxs("div",{className:"text-xs mt-2",children:["Czas: ",r.duration_minutes?`${r.duration_minutes} sek`:"—"]}),t.jsxs("div",{className:"text-xs",children:["Przezbrojenie: ",r.changeover_time??"—"]})]})]})]})]})]})}),e[107]=r,e[108]=J):J=e[108];let ge;return e[109]!==_||e[110]!==Q||e[111]!==Z||e[112]!==J?(ge=t.jsxs("div",{children:[_,Q,Z,J]}),e[109]=_,e[110]=Q,e[111]=Z,e[112]=J,e[113]=ge):ge=e[113],ge}function nt(s,e){return e+1}function lt(s){return Math.max(1,s-1)}function rt(s){return t.jsx("option",{value:s,children:Ce(s)},s)}function it(){}function ct(s){return s.ok?s.json():Promise.resolve([])}function gt(){const s=Re.c(15),e=Fe().props,p=e.allOperations;Array.isArray(p)&&p.length>0&&p[0];const[v,g]=b.useState(!1),[m,A]=b.useState(null);let x;s[0]===Symbol.for("react.memo_cache_sentinel")?(x=[{label:"Panel",href:"/moderator/dashboard"},{label:"Maszyny",href:"/moderator/machines"},{label:"Operacje",href:"/moderator/machines/operations"}],s[0]=x):x=s[0];const O=x;let S;s[1]===Symbol.for("react.memo_cache_sentinel")?(S=function(P){A(P),g(!0)},s[1]=S):S=s[1];const w=S;let $;s[2]!==m?($=function(){if(!m){g(!1);return}const P=m.id??m.operation_id??m.operation?.id;if(!P){g(!1);return}Ge.delete(`/moderator/machines/operations/${P}`,{onSuccess:()=>{g(!1),A(null)},onError:()=>{g(!1)}})},s[2]=m,s[3]=$):$=s[3];const N=$,d=e.auth?.user?.role??"user";let k;s[4]!==p||s[5]!==d?(k=t.jsx(at,{allOperations:p,currentUserRole:d,onDelete:w}),s[4]=p,s[5]=d,s[6]=k):k=s[6];let o;s[7]===Symbol.for("react.memo_cache_sentinel")?(o=()=>g(!1),s[7]=o):o=s[7];const ae=`Czy na pewno usunąć operację "${m?.operation?.name??m?.operation_name??""}"?`;let i;s[8]!==v||s[9]!==N||s[10]!==ae?(i=t.jsx(He,{open:v,onClose:o,onConfirm:N,title:"Usuń operację",message:ae,confirmText:"Usuń",cancelText:"Anuluj"}),s[8]=v,s[9]=N,s[10]=ae,s[11]=i):i=s[11];let E;return s[12]!==k||s[13]!==i?(E=t.jsxs(Ke,{breadcrumbs:O,title:"Machine Operations",children:[k,i]}),s[12]=k,s[13]=i,s[14]=E):E=s[14],E}export{gt as default};
