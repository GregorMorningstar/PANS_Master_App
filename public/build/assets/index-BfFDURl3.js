import{c as ve,u as be,j as t,L as Y,a as Z,r as pe}from"./app-6VWvmULT.js";import{M as Ne}from"./ModeratorLayout-BuZ7YoP3.js";import{B as ke}from"./app-sidebar-layout-DRLK_nj4.js";import{W as ge}from"./wrench-DYL9Y_76.js";import{U as ye,T as _e}from"./users-fBW5EpBz.js";import{P as Me}from"./pen-line-GxKorIJi.js";import{T as Pe}from"./trash-2-Cp2ifHGN.js";import{M as $e}from"./moderator-machine-nav-menu-1zDHkRIq.js";/* empty css            */import"./app-logo-icon-DrFhGwKx.js";import"./index-BCaWy0DS.js";import"./index-C2gJ1Fua.js";import"./index-C4J_hXM0.js";import"./index-DG9SYJJy.js";function ze(l){const e=ve.c(90),{machine:s,onEdit:c,onDelete:n,onView:o,onAddOperation:m,compact:O,user:V}=l,r=be();let h;e[0]!==r.props?.machineStatuses?(h=r.props?.machineStatuses??[],e[0]=r.props?.machineStatuses,e[1]=h):h=e[1];const a=h;let u;e[2]!==a?(u=a.reduce(Be,{}),e[2]=a,e[3]=u):u=e[3];const d=u;let f;e[4]!==s.status||e[5]!==d?(f=d[s.status??""]??{},e[4]=s.status,e[5]=d,e[6]=f):f=e[6];const ee=f,je=ee.color??"#3B82F6",we=ee.classes??"bg-slate-100 text-slate-800",te=ee.label??s.status??"nieznany";let R;if(e[7]!==r.props?.auth?.user||e[8]!==r.props?.user||e[9]!==V){let i;e:{const T=r.props?.auth?.user??r.props?.user??V??null;if(!T){i=[];break e}if(typeof T.role=="string"){i=[T.role];break e}if(Array.isArray(T.roles)){i=T.roles.map(Ee).filter(Boolean);break e}i=[]}R=i.some(Ae),e[7]=r.props?.auth?.user,e[8]=r.props?.user,e[9]=V,e[10]=R}else R=e[10];const se=R;let U;e[11]!==s||e[12]!==m?(U=function(x){if(x.preventDefault(),typeof m=="function")return m(s);Z.visit(`/moderator/machines/operations/${s.id}/add`)},e[11]=s,e[12]=m,e[13]=U):U=e[13];const ae=U;let F;e[14]!==s||e[15]!==o?(F=function(x){if(x.preventDefault(),typeof o=="function")return o(s);window.location.href=`/machines/failures/add-new/${s.id}`},e[14]=s,e[15]=o,e[16]=F):F=e[16];const re=F;let W;e[17]!==s||e[18]!==n?(W=function(x){if(x.preventDefault(),!!window.confirm(`Czy na pewno usunąć maszynę "${s.name??""}"?`)){if(typeof n=="function")return n(s);Z.delete(`/moderator/machines/${s.id}`,{onSuccess:Ce,onError:Se})}},e[17]=s,e[18]=n,e[19]=W):W=e[19];const ne=W;let G;e[20]!==s||e[21]!==c?(G=function(x){if(x.preventDefault(),typeof c=="function")return c(s);Z.visit(`/moderator/machines/${s.id}/edit`)},e[20]=s,e[21]=c,e[22]=G):G=e[22];const ie=G,le=String(s.barcode??s.serial_number??s.id??"BRK"),oe=s.image_path?`/storage/${s.image_path}`:"https://via.placeholder.com/320x240?text=Maszyna",H=s.owner?.name||(s.users&&s.users.length?s.users[0]?.name:null)||s.user?.name||"—",K=s.owner?.id||(s.users&&s.users.length?s.users[0]?.id:null)||s.user?.id||null,de=`2px solid ${je}`;let p;e[23]!==de?(p={borderLeft:de},e[23]=de,e[24]=p):p=e[24];let g;e[25]!==oe||e[26]!==s.name?(g=t.jsx("div",{className:"w-24 h-24 rounded-md overflow-hidden bg-gray-50 flex items-center justify-center border",children:t.jsx("img",{src:oe,alt:s.name,className:"object-cover w-full h-full"})}),e[25]=oe,e[26]=s.name,e[27]=g):g=e[27];const ce=s.name??"Brak nazwy";let y;e[28]!==ce?(y=t.jsx("div",{className:"text-sm font-semibold text-gray-800 truncate",children:ce}),e[28]=ce,e[29]=y):y=e[29];const me=s.model??s.serial_number??"brak modelu / nr";let b;e[30]!==me?(b=t.jsx("div",{className:"text-xs text-gray-500",children:me}),e[30]=me,e[31]=b):b=e[31];let j;e[32]!==y||e[33]!==b?(j=t.jsxs("div",{children:[y,b]}),e[32]=y,e[33]=b,e[34]=j):j=e[34];const ue=`px-2 py-0.5 text-xs rounded-md ${we}`;let w;e[35]!==te||e[36]!==ue?(w=t.jsx("span",{className:ue,children:te}),e[35]=te,e[36]=ue,e[37]=w):w=e[37];let v;e[38]!==s.department?(v=s.department?.id?t.jsx(Y,{href:`/moderator/departments/${s.department.id}`,className:"text-xs text-gray-500 hover:underline",children:s.department.name}):t.jsx("div",{className:"text-xs text-gray-500",children:"Brak działu"}),e[38]=s.department,e[39]=v):v=e[39];let N;e[40]!==w||e[41]!==v?(N=t.jsxs("div",{className:"flex flex-col items-end gap-1",children:[w,v]}),e[40]=w,e[41]=v,e[42]=N):N=e[42];let k;e[43]!==j||e[44]!==N?(k=t.jsxs("div",{className:"flex items-start justify-between gap-2",children:[j,N]}),e[43]=j,e[44]=N,e[45]=k):k=e[45];let _;e[46]!==le?(_=t.jsx("div",{className:"hidden sm:block",children:t.jsx("div",{className:"w-[110px]",children:t.jsx(ke,{value:le,format:"CODE128",height:28,width:.7,displayValue:!1,margin:0,renderer:"svg",lineColor:"#111827",background:"transparent"})})}),e[46]=le,e[47]=_):_=e[47];const xe=s.description??"Brak opisu";let M;e[48]!==xe?(M=t.jsx("div",{className:"text-xs text-gray-600 line-clamp-3",children:xe}),e[48]=xe,e[49]=M):M=e[49];let P;e[50]!==_||e[51]!==M?(P=t.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[_,M]}),e[50]=_,e[51]=M,e[52]=P):P=e[52];let $;e[53]!==k||e[54]!==P?($=t.jsxs("div",{className:"flex-1",children:[k,P]}),e[53]=k,e[54]=P,e[55]=$):$=e[55];let z;e[56]!==g||e[57]!==$?(z=t.jsxs("div",{className:"flex items-start gap-3",children:[g,$]}),e[56]=g,e[57]=$,e[58]=z):z=e[58];let q;e[59]===Symbol.for("react.memo_cache_sentinel")?(q=t.jsx(ge,{className:"w-4 h-4 text-indigo-500"}),e[59]=q):q=e[59];const fe=s.model??"—";let S;e[60]!==fe?(S=t.jsx("div",{className:"font-medium text-gray-800",children:fe}),e[60]=fe,e[61]=S):S=e[61];let J;e[62]===Symbol.for("react.memo_cache_sentinel")?(J=t.jsx("div",{className:"text-xs text-gray-500",children:"Model"}),e[62]=J):J=e[62];let C;e[63]!==S?(C=t.jsxs("div",{className:"rounded-md bg-white p-2 text-xs flex items-center gap-2 border",children:[q,t.jsxs("div",{children:[S,J]})]}),e[63]=S,e[64]=C):C=e[64];let A;e[65]!==K||e[66]!==H?(A=K?t.jsxs(Y,{href:`/moderator/users/${K}`,className:"rounded-md bg-white p-2 text-xs flex items-center gap-2 border hover:bg-slate-50",children:[t.jsx(ye,{className:"w-4 h-4 text-indigo-500"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:H}),t.jsx("div",{className:"text-xs text-gray-500",children:"Przypisany użytkownik"})]})]}):t.jsxs("div",{className:"rounded-md bg-white p-2 text-xs flex items-center gap-2 border",children:[t.jsx(ye,{className:"w-4 h-4 text-indigo-500"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:H}),t.jsx("div",{className:"text-xs text-gray-500",children:"Przypisany użytkownik"})]})]}),e[65]=K,e[66]=H,e[67]=A):A=e[67];let E;e[68]!==C||e[69]!==A?(E=t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[C,A]}),e[68]=C,e[69]=A,e[70]=E):E=e[70];const he=`/machines/failures/add-new/${s.id}`;let B;e[71]!==re?(B=i=>re(i),e[71]=re,e[72]=B):B=e[72];let Q;e[73]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsx(_e,{className:"text-slate-600 ",style:{color:"#ff0f0f"}}),e[73]=Q):Q=e[73];let D;e[74]!==he||e[75]!==B?(D=t.jsx(Y,{href:he,onClick:B,className:"inline-flex items-center justify-center w-10 h-10 rounded-md bg-white border shadow-sm hover:bg-slate-50",children:Q}),e[74]=he,e[75]=B,e[76]=D):D=e[76];let I;e[77]!==se||e[78]!==ne||e[79]!==ie||e[80]!==ae?(I=se&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:ae,className:"inline-flex items-center justify-center w-10 h-10 rounded-md bg-white border shadow-sm hover:bg-slate-50",children:t.jsx(ge,{className:"text-blue-500"})}),t.jsx("button",{onClick:ie,className:"inline-flex items-center justify-center w-10 h-10 rounded-md bg-white border shadow-sm hover:bg-slate-50",children:t.jsx(Me,{className:"text-green-500"})}),t.jsx("button",{onClick:ne,className:"inline-flex items-center justify-center w-10 h-10 rounded-md bg-white border shadow-sm hover:bg-slate-50",children:t.jsx(Pe,{className:"text-red-500"})})]}),e[77]=se,e[78]=ne,e[79]=ie,e[80]=ae,e[81]=I):I=e[81];let L;e[82]!==D||e[83]!==I?(L=t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[D,I]}),e[82]=D,e[83]=I,e[84]=L):L=e[84];let X;return e[85]!==p||e[86]!==z||e[87]!==E||e[88]!==L?(X=t.jsxs("div",{className:"w-full max-w-sm mx-auto rounded-xl border border-gray-200 bg-white shadow-sm p-3 flex flex-col gap-3 overflow-hidden",style:p,children:[z,E,L]}),e[85]=p,e[86]=z,e[87]=E,e[88]=L,e[89]=X):X=e[89],X}function Se(){alert("Błąd przy usuwaniu maszyny")}function Ce(){window.location.reload()}function Ae(l){return["admin","moderator"].includes(l)}function Ee(l){return l?.name??l}function Be(l,e){return e?.value&&(l[e.value]=e),l}function Je(){const e=be().props?.machines??[],s=e&&!Array.isArray(e)&&!!e.data,c=s?e.data??[]:Array.isArray(e)?e:[],n=6,[o,m]=pe.useState(1),O=Math.max(1,Math.ceil(c.length/n)),V=c.slice((o-1)*n,o*n);pe.useEffect(()=>{try{const a=e?.meta?.per_page??null;a&&Number(a)!==n&&s&&Z.get(window.location.pathname,{perPage:n},{replace:!0})}catch{}},[]);const r=s?c:V,h=[{label:"Panel Moderatora",href:"/moderator"},{label:"Panel sterowania maszyn",href:"/moderator/machines"}];return t.jsxs(Ne,{breadcrumbs:h,title:"Panel sterowania maszyn",children:[t.jsx($e,{}),t.jsx("div",{className:"mt-5",children:t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r.length>0?r.map(a=>t.jsx(ze,{machine:a,user:{role:"moderator"}},a.id)):t.jsx("p",{className:"text-gray-500 mx-4 my-6",children:"Brak maszyn do wyświetlenia."})})}),t.jsx("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50",children:s&&e.links?t.jsx("div",{className:"inline-flex items-center gap-2 bg-white shadow-lg rounded-full px-3 py-2 text-sm text-gray-800",children:e.links.map((a,u)=>{const d=!a.url,f=!!a.active;return t.jsx(Y,{href:a.url??"#",className:`inline-flex items-center justify-center px-3 py-1 rounded-full transition-colors duration-150
                      ${f?"bg-indigo-600 text-white shadow-md scale-105":"bg-white/0 text-gray-800 hover:bg-gray-100"}
                      ${d?"opacity-50 pointer-events-none":""}`,dangerouslySetInnerHTML:{__html:a.label},"aria-current":f?"page":void 0},u)})}):c.length>n&&t.jsxs("div",{className:"inline-flex items-center gap-2 bg-white shadow-lg rounded-full px-3 py-2 text-sm text-gray-800",children:[t.jsx("button",{onClick:()=>m(a=>Math.max(1,a-1)),disabled:o===1,className:"px-3 py-1 rounded-full hover:bg-gray-100 disabled:opacity-50",children:"Prev"}),Array.from({length:O}).map((a,u)=>{const d=u+1;return t.jsx("button",{onClick:()=>m(d),className:`px-3 py-1 rounded-full ${o===d?"bg-indigo-600 text-white":"hover:bg-gray-100"}`,children:d},d)}),t.jsx("button",{onClick:()=>m(a=>Math.min(O,a+1)),disabled:o===O,className:"px-3 py-1 rounded-full hover:bg-gray-100 disabled:opacity-50",children:"Next"})]})})]})}export{Je as default};
